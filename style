
# TOOL FOR KEEPING A DIARY LOG BASED ON QUESTIONS SPECIFIED AND ASKED BY THE USER


# import used for os specific line seperations
from os import linesep

# import used to check wether users file already exists or needs to be specified
import sys
from os.path import exists
import os

# import used for asking user to specify file location via tkinter GUI window
import tkinter as tk
from tkinter import filedialog

import datetime

def get_datetime_as_string():

    """Function for getting todays date/time as string
        so it can be added to the users diary log"""
    
    x = datetime.datetime.now()
    time_as_string = x.strftime("%c")
    return time_as_string



def get_questions_from_user():

    """ Asks user for questions they would like to ask themselves
        and adds them to a list 'users_question_list'. The list is later used in function
        'ask_and_await_answer'. Exits upon user typing QUIT """

    flag = True
    question_list = []
    
    while flag:
        users_question = (input('\n\nEnter your question here, or type QUIT \n\n'))
        if users_question == 'QUIT':
            print('\n')
            flag = False
        else:
            question_list.append(users_question)
    
    return question_list
    


def ask_and_await_answer(question_list):

    """ Asks user defined question from locally stored question file, waits for answer, 
    then takes date/time, question and answer and stores in a log file with appropriate
    line spacing for readability """
    

    datetime = get_datetime_as_string()
    
    # TAKES ANSWER AND WRITES DATE/TIME, QUESTION AND ANSWER TO SPECIFIED FILE
    
    # opens file as file object using append parameter
    destination_file = open(log_file_path,'a')

    for i in range(0, len(question_list)): 

        
        answer = input('\n\n' + question_list[i] + '\n\n')
        
        # outputs log in correct format for user to log file
       
        destination_file.write('\n\n' + datetime + '\n\n' 
        + question_list[i] + '\n\n' + answer + '\n\n')
        
    
    destination_file.close()
    
    #add extra line space in terminal for cleanliness
    print('\n')


def set_questions_file_path():

    """ Returns local path to users questions file """

    current_file_path = os.path.realpath(__file__)   
        
    questions_file_path = current_file_path.replace('diary_tool.py', 'questions')

    return questions_file_path
    

def set_log_file_path():


    """ Returns local path to users diary log file """

    current_file_path = os.path.realpath(__file__)
    
    log_file_path = current_file_path.replace('diary_tool.py', 'diary_log')

    return log_file_path


def format_stored_questions_for_user():
    
    """ Takes questions file object for reading; reads contents
        and simultaneously removes new lines and empty elements
        for when terminal output required."""

    # adds contents of questions file lines to list of questions    
    text_lines = questions_file_read.read().split('\n')

    # filters unwanted empty elements from list   
    question_list = list(filter(None, text_lines))        
    return question_list

    
if __name__ == '__main__':


    """ Functions that set up file paths """

    questions_path = set_questions_file_path()
    log_file_path = set_log_file_path()

    
    # opens file objects in either read or amend as appropriate for application
    # (some instances we want to read, others append)

    questions_file_read = open(questions_path, "r")
    questions_file_append = open(log_file_path, "a")
    
    log_file_append = open(log_file_path, "a")

    
    # initializes users question list from locally stored file
    users_question_list = format_stored_questions_for_user()
        

    """ THIS AREA takes CLI args to specify which functionality user wants, as follows:
        'input' to update questions
        'ask' to ask the questions user has stored previously
        'clearq' to clear all the users questions
        'reset' to delete all log entries and start over """

    # when no CLI arg is given

    if len(sys.argv) < 2:
        print('\n\nNo argument given. Please use "input" to update questions, "ask" to ask your questions, "clearq" to clear your questions, or "reset" to delete all log entries and start from scratch\n\n')
    
    # when there are too many CLI args

    elif len(sys.argv) > 2:
        print('Too many arguments given, only 1 is required')
    
    else:
        
        # asks user to input their questions
        
        if sys.argv[1] == 'input':

            questions = get_questions_from_user()

            # then iterates through list of questions and writes to questions file using question file object for appending
            for i in questions:

                questions_file_append.write((i + '\n\n'))
            

        

        elif sys.argv[1] == 'ask':
        
        # asks the user the questions that they previously input and stores results in log file
        # or if no questions are present, they are given the option to store questions with y or n    
        
            if users_question_list == []:
                
                flag = True
                while flag:
                    request = input("\n\n No questions currently stored. Run CLI arg 'input' to update questions, or would you like to update them now? y or n? \n\n")
                    
                    if request == 'y':
                        flag = False
                        questions = get_questions_from_user()
                        
                        # iterates through list of questions and writes to questions file
                        for i in questions:
                            questions_file_append.write((i + '\n\n'))                      
                    
                    elif request == 'n':
                        break
                    else:
                        print("\n\nPlease enter y or n to continue")
                    
            if users_question_list != []:
                ask_and_await_answer(users_question_list)             


        # clears the users question file

        elif sys.argv[1] == 'clearq':
            
            # resets the list that stores the questions for writing
            users_question_list = []
            
            # deletes contents of questions file
            open(questions_path, "w").close()
            
            print('\n\nQuestions cleared\n\n')

        
        # deletes everything from the log file

        elif sys.argv[1] == 'reset':
            open(log_file_path, "w").close()
            print('\n\nDiary log reset\n\n')

        elif sys.argv[1] == 'help':
            print('\n\nuse "input" to update questions, "ask" to ask your questions, "clearq" to clear your questions, or "reset" to delete all log entries and start from scratch\n\n')

        else:
            print('Invalid input')
diary_tool.py:2:80: E501 line too long (81 > 79 characters)
diary_tool.py:6:1: F401 'os.linesep' imported but unused
diary_tool.py:8:80: E501 line too long (80 > 79 characters)
diary_tool.py:10:1: F401 'os.path.exists' imported but unused
diary_tool.py:14:1: F401 'tkinter as tk' imported but unused
diary_tool.py:15:1: F401 'tkinter.filedialog' imported but unused
diary_tool.py:19:1: E302 expected 2 blank lines, found 1
diary_tool.py:23:1: W293 blank line contains whitespace
diary_tool.py:30:1: E303 too many blank lines (3)
diary_tool.py:33:80: E501 line too long (89 > 79 characters)
diary_tool.py:38:1: W293 blank line contains whitespace
diary_tool.py:40:80: E501 line too long (83 > 79 characters)
diary_tool.py:46:1: W293 blank line contains whitespace
diary_tool.py:48:1: W293 blank line contains whitespace
diary_tool.py:51:1: E303 too many blank lines (3)
diary_tool.py:53:80: E501 line too long (83 > 79 characters)
diary_tool.py:53:84: W291 trailing whitespace
diary_tool.py:54:80: E501 line too long (87 > 79 characters)
diary_tool.py:56:1: W293 blank line contains whitespace
diary_tool.py:58:5: E303 too many blank lines (2)
diary_tool.py:59:1: W293 blank line contains whitespace
diary_tool.py:61:1: W293 blank line contains whitespace
diary_tool.py:63:42: E231 missing whitespace after ','
diary_tool.py:65:43: W291 trailing whitespace
diary_tool.py:67:1: W293 blank line contains whitespace
diary_tool.py:68:9: E303 too many blank lines (2)
diary_tool.py:69:1: W293 blank line contains whitespace
diary_tool.py:71:1: W293 blank line contains whitespace
diary_tool.py:72:58: W291 trailing whitespace
diary_tool.py:73:9: E128 continuation line under-indented for visual indent
diary_tool.py:74:1: W293 blank line contains whitespace
diary_tool.py:75:1: W293 blank line contains whitespace
diary_tool.py:76:5: E303 too many blank lines (2)
diary_tool.py:77:1: W293 blank line contains whitespace
diary_tool.py:78:5: E265 block comment should start with '# '
diary_tool.py:86:51: W291 trailing whitespace
diary_tool.py:87:1: W293 blank line contains whitespace
diary_tool.py:88:80: E501 line too long (81 > 79 characters)
diary_tool.py:91:1: W293 blank line contains whitespace
diary_tool.py:96:5: E303 too many blank lines (2)
diary_tool.py:99:1: W293 blank line contains whitespace
diary_tool.py:106:1: W293 blank line contains whitespace
diary_tool.py:111:65: W291 trailing whitespace
diary_tool.py:114:48: W291 trailing whitespace
diary_tool.py:115:51: W291 trailing whitespace
diary_tool.py:118:1: W293 blank line contains whitespace
diary_tool.py:122:5: E303 too many blank lines (2)
diary_tool.py:127:1: W293 blank line contains whitespace
diary_tool.py:128:5: E303 too many blank lines (2)
diary_tool.py:133:1: W293 blank line contains whitespace
diary_tool.py:136:1: W293 blank line contains whitespace
diary_tool.py:137:5: E303 too many blank lines (2)
diary_tool.py:139:1: W293 blank line contains whitespace
diary_tool.py:141:5: E303 too many blank lines (2)
diary_tool.py:141:80: E501 line too long (83 > 79 characters)
diary_tool.py:150:80: E501 line too long (206 > 79 characters)
diary_tool.py:151:1: W293 blank line contains whitespace
diary_tool.py:156:1: W293 blank line contains whitespace
diary_tool.py:158:1: W293 blank line contains whitespace
diary_tool.py:160:1: W293 blank line contains whitespace
diary_tool.py:165:80: E501 line too long (123 > 79 characters)
diary_tool.py:169:1: W293 blank line contains whitespace
diary_tool.py:171:1: W293 blank line contains whitespace
diary_tool.py:173:9: E303 too many blank lines (4)
diary_tool.py:174:1: W293 blank line contains whitespace
diary_tool.py:175:9: E115 expected an indented block (comment)
diary_tool.py:175:80: E501 line too long (95 > 79 characters)
diary_tool.py:176:9: E115 expected an indented block (comment)
diary_tool.py:176:80: E501 line too long (98 > 79 characters)
diary_tool.py:176:99: W291 trailing whitespace
diary_tool.py:177:1: W293 blank line contains whitespace
diary_tool.py:179:1: W293 blank line contains whitespace
diary_tool.py:182:80: E501 line too long (166 > 79 characters)
diary_tool.py:183:1: W293 blank line contains whitespace
diary_tool.py:187:1: W293 blank line contains whitespace
diary_tool.py:188:80: E501 line too long (89 > 79 characters)
diary_tool.py:190:70: W291 trailing whitespace
diary_tool.py:191:1: W293 blank line contains whitespace
diary_tool.py:196:1: W293 blank line contains whitespace
diary_tool.py:198:58: W291 trailing whitespace
diary_tool.py:201:9: E303 too many blank lines (2)
diary_tool.py:204:1: W293 blank line contains whitespace
diary_tool.py:207:1: W293 blank line contains whitespace
diary_tool.py:210:1: W293 blank line contains whitespace
diary_tool.py:213:1: W293 blank line contains whitespace
diary_tool.py:214:9: E303 too many blank lines (2)
diary_tool.py:221:80: E501 line too long (184 > 79 characters)
